// Interface principal da aplicação Docker UI

// Ponto de dados para gráficos
struct ChartPoint {
    time: string,
    value: float,
}

// Dados básicos de um container
struct ContainerData {
    id: string,
    name: string,
    image: string,
    state: string,
    status: string,
}

// Card para exibir estatísticas
component StatCard inherits Rectangle {
    in property <string> title;
    in property <string> value;
    in property <color> value-color: #ffffff;

    // Estilo do card
    width: 288px;
    height: 112px;
    background: #2e3030;
    border-radius: 8px;

    HorizontalLayout {
        padding-left: 32px;
        alignment: start;

        VerticalLayout {
            alignment: center;
            spacing: 8px;

            Text {
                text: root.title;
                color: #ffffff;
                font-size: 18px;
            }

            Text {
                text: root.value;
                color: root.value-color;
                font-size: 24px;
                font-weight: 700;
            }
        }
    }
}

// Container para gráficos com título e valor atual
component ChartContainer inherits Rectangle {
    in property <string> title;
    in property <string> current-value;
    in property <color> chart-color: #3b82f6;
    in property <image> chart-image;

    background: #2e3030;
    border-radius: 8px;

    VerticalLayout {
        padding: 24px;
        spacing: 16px;

        HorizontalLayout {
            alignment: space-between;

            HorizontalLayout {
                spacing: 16px;
                alignment: start;

                Text {
                    text: root.title;
                    color: #ffffff;
                    font-size: 18px;
                    font-weight: 600;
                }

                Text {
                    text: root.current-value;
                    color: root.chart-color;
                    font-size: 18px;
                    font-weight: 700;
                }
            }

            Text {
                text: "Último minuto";
                color: #ffffff;
                font-size: 14px;
            }
        }

        Image {
            source: root.chart-image;
            width: 100%;
            height: 256px;
        }
    }
}

// Botão do cabeçalho com estado ativo
component HeaderButton inherits Rectangle {
    in property <string> text;
    in property <bool> active: false;
    callback clicked <=> touch.clicked;

    height: 32px;
    background: root.active ? #2e3030 : transparent;
    border-radius: 6px;

    touch := TouchArea { }

    HorizontalLayout {
        padding: 8px;

        Text {
            text: root.text;
            color: #ffffff;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }
}

// Tela principal do dashboard com estatísticas
component DashboardView inherits VerticalLayout {
    // Propriedades de informações do Docker
    in property <int> total-containers;
    in property <int> running-containers;
    in property <int> stopped-containers;
    in property <int> paused-containers;
    in property <int> total-images;
    in property <string> docker-version;
    // Propriedades de uso do sistema
    in property <string> cpu-usage-str;
    in property <string> memory-percentage-str;
    in property <string> network-rx-str;
    in property <string> network-tx-str;
    in property <image> cpu-chart;
    in property <image> memory-chart;

    spacing: 20px;
    padding: 16px;
    padding-top: 20px;

    // Grid de cards de estatísticas
    HorizontalLayout {
        alignment: center;
        height: 240px;

        GridLayout {
            spacing: 16px;

            StatCard {
                row: 0;
                col: 0;
                title: "Total Containers";
                value: root.total-containers;
            }

            StatCard {
                row: 0;
                col: 1;
                title: "Containers Rodando";
                value: root.running-containers;
                value-color: #0AD95C;
            }

            StatCard {
                row: 0;
                col: 2;
                title: "Containers Parados";
                value: root.stopped-containers;
                value-color: #FA6138;
            }

            StatCard {
                row: 1;
                col: 0;
                title: "Containers Pausados";
                value: root.paused-containers;
                value-color: #ffac51;
            }

            StatCard {
                row: 1;
                col: 1;
                title: "Imagens";
                value: root.total-images;
            }

            StatCard {
                row: 1;
                col: 2;
                title: "Versão | Arquitetura";
                value: root.docker-version;
            }
        }
    }

    // Seção de gráficos
    VerticalLayout {
        spacing: 16px;
        alignment: start;

        Text {
            text: "Dados de uso do Docker";
            color: #ffffff;
            font-size: 24px;
            font-weight: 600;
        }

        Flickable {

            VerticalLayout {
                spacing: 24px;

                ChartContainer {
                    title: "Uso de CPU";
                    current-value: root.cpu-usage-str;
                    chart-color: #3b82f6;
                    chart-image: root.cpu-chart;
                }

                ChartContainer {
                    title: "Uso de Memória";
                    current-value: root.memory-percentage-str;
                    chart-color: #10b981;
                    chart-image: root.memory-chart;
                }

                // Card de uso de rede
                Rectangle {
                    background: #2e3030;
                    border-radius: 8px;
                    height: 300px;

                    VerticalLayout {
                        padding: 24px;
                        spacing: 16px;

                        HorizontalLayout {
                            alignment: space-between;

                            HorizontalLayout {
                                spacing: 16px;
                                alignment: start;

                                Text {
                                    text: "Uso de Rede";
                                    color: #ffffff;
                                    font-size: 18px;
                                    font-weight: 600;
                                }

                                HorizontalLayout {
                                    spacing: 16px;

                                    Text {
                                        text: root.network-rx-str;
                                        color: #f59e0b;
                                        font-size: 16px;
                                        font-weight: 700;
                                    }

                                    Text {
                                        text: root.network-tx-str;
                                        color: #ef4444;
                                        font-size: 16px;
                                        font-weight: 700;
                                    }
                                }
                            }

                            Text {
                                text: "Último minuto";
                                color: #ffffff;
                                font-size: 14px;
                            }
                        }

                        // Seção RX/TX da rede
                        HorizontalLayout {
                            spacing: 8px;

                            // Card RX (Download)
                            Rectangle {
                                width: 50%;
                                height: 200px;
                                background: #1e1f1f;
                                border-radius: 4px;

                                VerticalLayout {
                                    alignment: center;

                                    Text {
                                        text: "RX (Download)";
                                        color: #f59e0b;
                                        font-size: 14px;
                                        font-weight: 600;
                                        horizontal-alignment: center;
                                    }

                                    Text {
                                        text: root.network-rx-str;
                                        color: #f59e0b;
                                        font-size: 20px;
                                        font-weight: 700;
                                        horizontal-alignment: center;
                                    }

                                    Text {
                                        text: "Gráfico em tempo real";
                                        color: #888888;
                                        font-size: 12px;
                                        horizontal-alignment: center;
                                    }
                                }
                            }

                            // Card TX (Upload)
                            Rectangle {
                                width: 50%;
                                height: 200px;
                                background: #1e1f1f;
                                border-radius: 4px;

                                VerticalLayout {
                                    alignment: center;

                                    Text {
                                        text: "TX (Upload)";
                                        color: #ef4444;
                                        font-size: 14px;
                                        font-weight: 600;
                                        horizontal-alignment: center;
                                    }

                                    Text {
                                        text: root.network-tx-str;
                                        color: #ef4444;
                                        font-size: 20px;
                                        font-weight: 700;
                                        horizontal-alignment: center;
                                    }

                                    Text {
                                        text: "Gráfico em tempo real";
                                        color: #888888;
                                        font-size: 12px;
                                        horizontal-alignment: center;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

// Tela de containers (placeholder)
component ContainersView inherits VerticalLayout {
    padding: 16px;

    Text {
        text: "Containers";
        color: #ffffff;
        font-size: 24px;
        font-weight: 600;
    }

    Rectangle {
        background: #2e3030;
        border-radius: 8px;
        height: 400px;

        Text {
            text: "Lista de containers será implementada aqui";
            color: #9ca3af;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }
}

// Tela de imagens (placeholder)
component ImagesView inherits VerticalLayout {
    padding: 16px;

    Text {
        text: "Images";
        color: #ffffff;
        font-size: 24px;
        font-weight: 600;
    }

    Rectangle {
        background: #2e3030;
        border-radius: 8px;
        height: 400px;

        Text {
            text: "Lista de imagens será implementada aqui";
            color: #9ca3af;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }
}

// Tela de redes (placeholder)
component NetworksView inherits VerticalLayout {
    padding: 16px;

    Text {
        text: "Networks";
        color: #ffffff;
        font-size: 24px;
        font-weight: 600;
    }

    Rectangle {
        background: #2e3030;
        border-radius: 8px;
        height: 400px;

        Text {
            text: "Lista de redes será implementada aqui";
            color: #9ca3af;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }
}

// Tela de volumes (placeholder)
component VolumesView inherits VerticalLayout {
    padding: 16px;

    Text {
        text: "Volumes";
        color: #ffffff;
        font-size: 24px;
        font-weight: 600;
    }

    Rectangle {
        background: #2e3030;
        border-radius: 8px;
        height: 400px;

        Text {
            text: "Lista de volumes será implementada aqui";
            color: #9ca3af;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }
}

// Janela principal da aplicação
export component AppWindow inherits Window {
    // Propriedades gerais
    in-out property <string> docker-status: "Desconhecido";
    in-out property <int> current-screen: 0;

    // Propriedades de informações do Docker
    in-out property <int> total-containers;
    in-out property <int> running-containers;
    in-out property <int> stopped-containers;
    in-out property <int> paused-containers;
    in-out property <int> total-images;
    in-out property <string> docker-version;

    // Propriedades de estatísticas do sistema
    in-out property <string> cpu-usage-str;
    in-out property <string> memory-percentage-str;
    in-out property <string> network-rx-str;
    in-out property <string> network-tx-str;
    in-out property <image> cpu-chart;
    in-out property <image> memory-chart;

    // Callbacks para interação
    callback screen-changed(int);

    title: "Docker UI";
    width: 950px;
    height: 1024px;
    background: #1A1B1B;

    VerticalLayout {

        // Cabeçalho da aplicação
        Rectangle {
            height: 48px;
            vertical-stretch: 0;
            background: #1A1B1B;
            border-width: 1px;
            border-color: transparent;


            // Linha separadora do cabeçalho
            Rectangle {
                width: 100%;
                height: 1px;
                background: #E5E8EB;
                y: parent.height - 1px;
            }

            HorizontalLayout {
                padding: 16px;
                alignment: space-between;

                HorizontalLayout {
                    spacing: 24px;
                    alignment: start;

                    // Botão principal do dashboard
                    HeaderButton {
                        text: "Docker UI";
                        clicked => {
                            root.screen-changed(0);
                        }
                    }

                    HeaderButton {
                        text: "Containers";
                        active: root.current-screen == 1;
                        clicked => {
                            root.screen-changed(1);
                        }
                    }

                    HeaderButton {
                        text: "Images";
                        active: root.current-screen == 2;
                        clicked => {
                            root.screen-changed(2);
                        }
                    }

                    HeaderButton {
                        text: "Networks";
                        active: root.current-screen == 3;
                        clicked => {
                            root.screen-changed(3);
                        }
                    }

                    HeaderButton {
                        text: "Volumes";
                        active: root.current-screen == 4;
                        clicked => {
                            root.screen-changed(4);
                        }
                    }
                }
            }
        }

        // Conteúdo principal
        Rectangle {
            height: parent.height - 32px - 48px - 32px;

            background: #1A1B1B;
            vertical-stretch: 1;

            // Dashboard principal
            if root.current-screen == 0: DashboardView {
                total-containers: root.total-containers;
                running-containers: root.running-containers;
                stopped-containers: root.stopped-containers;
                paused-containers: root.paused-containers;
                total-images: root.total-images;
                docker-version: root.docker-version;
                cpu-usage-str: root.cpu-usage-str;
                memory-percentage-str: root.memory-percentage-str;
                network-rx-str: root.network-rx-str;
                network-tx-str: root.network-tx-str;
                cpu-chart: root.cpu-chart;
                memory-chart: root.memory-chart;
            }

            // Outras telas da aplicação
            if root.current-screen == 1: ContainersView { }
            if root.current-screen == 2: ImagesView { }
            if root.current-screen == 3: NetworksView { }
            if root.current-screen == 4: VolumesView { }
        }

        // Rodapé com status do Docker
        Rectangle {
            height: 32px;
            background: #1A1B1B;
            vertical-stretch: 0;

            HorizontalLayout {
                padding: 4px;
                padding-left: 8px;
                alignment: start;


                // Indicador de status do Docker
                Text {
                    text: "Status: " + root.docker-status;
                    color: root.docker-status == "Rodando" ? #0AD95C : #FA6138;
                    font-size: 14px;
                }
            }
        }
    }
}
